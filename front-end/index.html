<html>
    <head>
        <title>Test</title>
    </head>
    <body>
        <h3>Вход</h3>
        <form method='post' action='/enter'>
            <input type='text' name='login' placeholder='login' id='login'><br>
            <input type='text' name='pass' placeholder='pass' id='pass'><br>
            <input type='submit' value='OK' id='ok' class='buttons'>
        </form>

        <h3>Регистрация</h3>
        <form method='post' action='/reg'>
            <input type='text' name='login' placeholder='login' id='loginR'><br>
            <input type='text' name='pass' placeholder='pass' id='passR'><br>
            <input type='submit' value='OK' id='okR' class='buttons'>
        </form>

        <h3>Формирование Бюджета</h3>
        <form method='post' action='/reg'>
            <input type='text' name='money' placeholder='money' id='loginB'><br>
            <input type='text' name='count' placeholder='count' id='countB'><br>
            <input type='text' name='day' placeholder='now' id='dayB'><br>
            <input type='text' name='id' placeholder='id' id='idB'><br>
            <input type='submit' value='OK' id='okB' class='buttons'>
        </form>

        <h3>Добавление источников дохода</h3>
        <form method='post' action='/reg'>
            <input type='text' name='id' placeholder='id_user' id='loginD'><br>
            <input type='text' name='name' placeholder='name' id='countD'><br>
            <input type='text' name='type' placeholder='type' id='dayD'><br>
            <input type='submit' value='OK' id='okD' class='buttons'>
        </form>
    </body>

    <script>
    const sendJSON = (data, path) => { //отправка данных на сервер POST-запросом
        const xhr = new XMLHttpRequest(),
                json = JSON.stringify(data);
        xhr.open('POST', path, true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        xhr.send(json);

        return xhr;
    };
    
    // document.querySelector('#ok').addEventListener('click', event => {
    //     event.preventDefault();
    //     const data = {
    //         login: document.querySelector('#login').value,
    //         pass: document.querySelector('#pass').value
    //     };

    //     sendJSON(data, '/enter');
    // });

    // document.querySelector('#okR').addEventListener('click', event => {
    //     event.preventDefault();
    //     const data = {
    //         login: document.querySelector('#loginR').value,
    //         pass: document.querySelector('#passR').value
    //     };

    //     sendJSON(data, '/reg');
    // });

    // document.querySelector('#okB').addEventListener('click', event => {
    //     event.preventDefault();
    //     const data = {
    //         money: document.querySelector('#loginB').value,
    //         count: document.querySelector('#countB').value,
    //         start: document.querySelector('#dayB').value,
    //         id: document.querySelector('#idB').value
    //     };

    //     sendJSON(data, '/time');
    // });

    function main(arrayButtons) {
        for (let i=0; i<arrayButtons.length; i++) {
            arrayButtons[i].addEventListener('click', event => {
                event.preventDefault();
                const parent = event.target.parentNode,
                      input = parent.querySelectorAll('input'),
                      data = {};
                for (let j=0; j<input.length-1; j++) {
                    data[input[j].name] = input[j].value;
                }
                console.log(data);
                const xhr = sendJSON(data, arrayButtons[i].path);
                xhr.onreadystatechange = function() { // (3)
                    if (xhr.readyState != 4) return;
                    console.log(xhr.response);
                }
            });
        }

    };

    const buttons = document.querySelectorAll('.buttons');
    buttons[0].path = '/enter';
    buttons[1].path = '/reg';
    buttons[2].path = '/time';
    buttons[3].path = '/source';
    main(buttons);
    </script>
</html>